all_data = [0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	1.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000
0.200458	0.189359	0.223228	0.228620	0.233275	0.222404	0.229785	0.216513	0.192187	1.000000	0.357797	0.351871	0.357797	1.000000	0.347907	0.351871	0.347907	1.000000	1.000000	0.475271	0.513355	0.475271	1.000000	0.485742	0.513355	0.485742	1.000000
0.000000	-1.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	-1.000000	0.000000	1.000000	0.000000
-0.174554	0.076004	-0.265561	-0.241110	0.077905	-0.278191	-0.258708	0.080449	-0.291794	1.000000	0.808309	0.828855	0.808309	1.000000	0.873573	0.828855	0.873573	1.000000	1.000000	0.085315	0.268028	0.085315	1.000000	0.072828	0.268028	0.072828	1.000000
0.000000	-1.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000
-0.086601	0.129635	0.205091	-0.118472	0.165902	0.273573	-0.145115	0.160356	0.316790	1.000000	0.448273	0.487169	0.448273	1.000000	0.635090	0.487169	0.635090	1.000000	1.000000	0.189680	0.161283	0.189680	1.000000	0.333690	0.161283	0.333690	1.000000
1.000000	1.000000	-2.000000	1.000000	1.000000	1.000000	1.000000	1.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000
-0.182004	-0.082783	0.076808	-0.105948	-0.073218	-0.094769	-0.140677	-0.098896	0.131344	1.000000	0.406049	0.485885	0.406049	1.000000	0.423175	0.485885	0.423175	1.000000	1.000000	0.345195	0.359847	0.345195	1.000000	0.282179	0.359847	0.282179	1.000000
1.000000	-8.000000	0.000000	0.000000	3.000000	0.000000	1.000000	0.000000	1.000000	0.000000	2.000000	0.000000	-2.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	8.000000	0.000000	-8.000000	0.000000	-4.000000	0.000000	4.000000	0.000000
-0.478564	0.686845	-0.072646	0.253767	0.332951	0.092572	-0.113638	0.122523	-0.062666	1.000000	0.320274	0.204870	0.320274	1.000000	0.253442	0.204870	0.253442	1.000000	1.000000	0.557967	0.534290	0.557967	1.000000	0.120761	0.534290	0.120761	1.000000
0.000000	-1.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000
0.750682	0.515276	0.727227	0.762217	0.485839	0.767222	0.773989	0.533700	0.781848	1.000000	0.922375	0.911057	0.922375	1.000000	0.970681	0.911057	0.970681	1.000000	1.000000	0.674072	0.966375	0.674072	1.000000	0.780596	0.966375	0.780596	1.000000
-1.000000	1.000000	0.000000	5.000000	5.000000	0.000000	0.000000	6.000000	0.000000	0.000000	1.000000	0.000000	-1.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	4.000000	0.000000	-4.000000	0.000000	1.000000	0.000000	-1.000000	0.000000
0.153563	0.397014	0.146824	-0.059917	0.167696	0.075384	0.215931	-0.143739	0.222258	1.000000	0.154643	0.335047	0.154643	1.000000	0.266533	0.335047	0.266533	1.000000	1.000000	0.242965	0.295212	0.242965	1.000000	0.111961	0.295212	0.111961	1.000000];


lag = all_data(1:2:end, :);
rho = all_data(2:2:end, :);

for di = 1:2
    switch di
        case {1}
            input = rho;
            mt = 1;
        case {2}
            input = lag;
            mt = -1;
    end
    
    mat = zeros(6,6,size(input, 1));
    for i = 1:size(input, 1)
        datavec = input(i,:);
        
        tmat = zeros(6,6);
        tmat(1,4:6) = datavec(1:3);
        tmat(2,4:6) = datavec(4:6);
        tmat(3,4:6) = datavec(7:9);
        tmat(1,1:3) = datavec(10:12);
        tmat(2,1:3) = datavec(13:15);
        tmat(3,1:3) = datavec(16:18);
        tmat(4,4:6) = datavec(19:21);
        tmat(5,4:6) = datavec(22:24);
        tmat(6,4:6) = datavec(25:27);
        
        tmat(4:6,1) = mt*datavec(1:3);
        tmat(4:6,2) = mt*datavec(4:6);
        tmat(4:6,3) = mt*datavec(7:9);
        
        mat(:,:,i) = tmat; 
    end
    
    switch di
        case {1}
            rhomat = mat;
        case {2}
            lagmat = mat;
    end
    
end

save('crosscor.mat', 'rho', 'lag', 'rhomat', 'lagmat')
clearvars -except rho lag rhomat lagmat
